<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>IPL Live Auction</title>
    <link rel="icon" type="image/png" href="/logo.png?v=2">
    <link rel="shortcut icon" type="image/png" href="/logo.png?v=2">
    <link rel="apple-touch-icon" href="/logo.png?v=2">

    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;800&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="/style.css">
    <!-- Vite-built React landing (no CDN Tailwind/React/Babel = less lag during bidding) -->
    <link rel="stylesheet" href="/assets/landing.css">
</head>

<body>
<canvas id="bg-canvas"></canvas>
<section id="landing" class="screen landing-scrollable" style="background: transparent !important; position: relative; z-index: 10;">
    <div id="landing-root"></div>
</section>


<section id="auth" class="screen hidden">
    <div class="auth-wrapper">
        <div class="glass auth-card" style="max-width: 500px; padding:0; overflow:hidden; border:1px solid rgba(255,255,255,0.1);">
            
            <div class="auth-tabs" style="display:flex; border-bottom:1px solid rgba(255,255,255,0.1);">
                <button onclick="switchAuthTab('join')" class="auth-tab-btn active" id="tabJoin" style="flex:1;">JOIN ROOM</button>
                <button onclick="switchAuthTab('create')" class="auth-tab-btn" id="tabCreate" style="flex:1;">CREATE ROOM</button>
            </div>

            <div style="padding: 25px;">
                <input id="username" placeholder="Enter Display Name" style="margin-bottom: 20px; background:rgba(0,0,0,0.3); border-color:rgba(255,255,255,0.1);">

                <div id="joinSection">
                    <div style="display:flex; gap:10px; margin-bottom:20px;">
                        <input id="code" placeholder="ROOM CODE" style="text-transform: uppercase; letter-spacing: 2px; font-family:monospace; font-weight:700; text-align:center;">
                        <button id="joinBtn" class="primary-btn" style="padding:0 30px;">GO</button>
                    </div>
                    
                    <div class="divider" style="margin: 15px 0; font-size:0.7rem; letter-spacing:1px;">PUBLIC ROOMS</div>
                    <div id="publicRoomList" class="room-list-box custom-scroll">
                        <div style="color:#aaa; font-size:0.9rem; text-align:center; padding:10px;">Fetching rooms...</div>
                    </div>
                </div>

                <div id="createSection" class="hidden">
                    <div style="margin-bottom: 20px; background:rgba(255,255,255,0.03); padding:10px; border-radius:8px;">
                        <label class="toggle-switch" style="width:100%; justify-content:space-between;">
                            <span class="label-text" style="font-size:0.9rem;">Public Room</span>
                            <input type="checkbox" id="isPublicRoom" checked>
                            <span class="slider"></span>
                        </label>
                    </div>

                    <label style="font-size: 0.75rem; color: #94a3b8; display: block; margin-bottom: 10px; font-weight:700; letter-spacing:1px;">SELECT PLAYER POOL</label>
                    
                    <div class="dataset-scroll-container">
                        <div class="dataset-card active" onclick="selectDataset('ipl2026', this)">
                            <div class="ds-icon">üèÜ</div>
                            <div class="ds-title">IPL 2026</div>
                            <div class="ds-sub">Standard</div>
                        </div>
                        <div class="dataset-card" onclick="selectDataset('legends', this)">
                            <div class="ds-icon">üî•</div>
                            <div class="ds-title">LEGENDS</div>
                            <div class="ds-sub">All-Time</div>
                        </div>
                        <div class="dataset-card" onclick="selectDataset('mixed', this)">
                            <div class="ds-icon">‚öîÔ∏è</div>
                            <div class="ds-title">MIXED</div>
                            <div class="ds-sub">Great Icon</div>
                        </div>
                        <div class="dataset-card" onclick="selectDataset('custom', this)">
                            <div class="ds-icon">üõ†Ô∏è</div>
                            <div class="ds-title">CUSTOM</div>
                            <div class="ds-sub">Builder</div>
                        </div>
                    </div>
                    <input type="hidden" id="selectedSetId" value="ipl2026">

                    <button id="createBtn" class="primary-btn" style="width:100%; margin-top:25px; box-shadow:0 4px 15px rgba(99, 102, 241, 0.3);">CREATE ROOM</button>
                </div>
            </div>
        </div>
    </div>
</section>
<section id="auctionUI" class="screen hidden">

<header class="topbar">
    <div class="topbar-row">
        <div class="topbar-left">
            <div id="roomCodeBadge" class="header-badge" onclick="copyRoomCode()" style="border:1px solid var(--primary); color:var(--primary);">
                <span id="roomCodeText" style="font-family:monospace; font-weight:700;">---</span>
            </div>
            <div id="headerTeamBadge" class="header-badge hidden" style="background:var(--gold); color:#000; font-weight:600; border:none;">
                <span id="headerTeamName">---</span>
            </div>
            <button onclick="toggleUserList(event)" class="count-pill-btn" type="button">
                <span class="pulse-dot"></span>
                <span id="liveUserCount">0</span>
            </button>
        </div>
        <div class="topbar-middle">
            <button id="lateJoinBtn" onclick="toggleLateJoin()" class="header-icon-btn hidden header-icon-btn-label">
                <span class="icon">‚úö</span>
                <span class="label">Join Team</span>
            </button>
            <button id="rulesBtn" onclick="showRules()" class="header-icon-btn" title="Rules">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/><path d="M8 7h8"/><path d="M8 11h8"/></svg>
            </button>
            <button id="toggleMuteBtn" class="header-icon-btn mute-toggle-btn" onclick="toggleMute()" title="Toggle Sound" aria-label="Mute sound">
                <span id="soundIconUnmuted" class="mute-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></svg></span>
                <span id="soundIconMuted" class="mute-icon hidden"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg></span>
            </button>
        </div>
        <div class="topbar-right">
            <span id="adminControls" class="admin-group hidden">
                <button id="startBtn" class="header-icon-btn primary header-icon-btn-label" title="Start">
                    <span class="icon">‚ñ∂</span>
                    <span class="label">Start</span>
                </button>
                <button id="togglePauseBtn" class="header-icon-btn" title="Pause">‚è∏</button>
                <button id="skipBtn" class="header-icon-btn" title="Skip">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"/><line x1="19" y1="5" x2="19" y2="19"/></svg>
                </button>
                <button id="skipSetBtn" class="header-icon-btn warning" title="Skip Set">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 19 22 12 13 5 13 19"/><polygon points="2 19 11 12 2 5 2 19"/></svg>
                </button>
                <button id="endBtn" onclick="admin('end')" class="header-icon-btn danger" title="End Game">‚äò</button>
            </span>
            <button id="leaveBtn" class="header-icon-btn danger hidden" title="Leave">
                <img src="https://img.icons8.com/material-outlined/24/emergency-exit.png" alt="Leave" width="24" height="24" />
            </button>
        </div>
    </div>
    
    <div id="userListDropdown" class="user-list-dropdown hidden glass" style="left:10px; top:50px;">
        <h4 style="margin:0 0 10px 0; color:#94a3b8; font-size:0.7rem;">ACTIVE USERS</h4>
        <div id="userListContent"></div>
    </div>
</header>


    <div class="auction-wrapper">
        
        <div class="auction-center">
            
            <div id="teamSelectionMain" class="glass" style="width: 100%; max-width: 530px;">
                <h2 style="color:var(--primary); margin:0 0 4px 0; font-size:1rem;">CHOOSE YOUR TEAM</h2>
                <p style="color:#aaa; font-size:0.8rem; margin:0 0 10px 0;">Select a team to participate.</p>
                <div id="embeddedTeamList" class="team-list"></div>
                <div id="waitingForHostMsg" class="hidden" style="margin-top:10px; padding:10px; background:rgba(255,255,255,0.05); border-radius:8px;">
                    <h3 style="margin:0 0 2px 0; font-size:0.95rem; color:#22c55e;">‚úÖ Team Selected</h3>
                    <p style="color:#aaa; font-size:0.8rem; margin:0;">Waiting for Host to start...</p>
                </div>
            </div>

            <div class="auction glass hidden" id="auctionCard">
                <div id="resultOverlay" class="ac-result-overlay hidden"></div>
                <div id="rtmOverlay" class="ac-result-overlay hidden">
                    <div class="premium-fullcard">
                        <div class="pf-title" style="color:var(--gold);">Issuing RTM</div>
                        <div class="pf-detail">Right to Match in progress</div>
                    </div>
                </div>

                <div class="ac-top-row">
                    <div class="ac-info-box">
                        <div id="playerName" class="ac-name-text">WAITING...</div>
                        <div id="playerMeta" class="ac-role-text">---</div>
                    </div>

                    <div class="ac-status-box">
                        <div id="timer" class="ac-timer-box two-digit">10</div>
                        <div id="currentBidder" class="ac-leader-badge hidden">
                            <span id="bidderName">---</span>
                        </div>
                    </div>
                </div>

                <div class="ac-bot-row">
                    <div class="ac-price-box">
                        <span class="lbl">CURRENT BID</span>
                        <div id="bid" class="val">‚Çπ0.00 Cr</div>
                    </div>

                    <button id="bidBtn" class="ac-main-bid-btn">
                        <span style="font-size:1.5rem; font-weight:800;">BID</span>
                        <span id="btnIncText" style="font-size:0.75rem; font-family:monospace; opacity:0.8;"></span>
                    </button>
                </div>
            </div>
        </div>

        <div id="commandCenter" class="glass">
            
            <div class="cc-tabs">
                <button class="cc-tab-btn" data-tab="sets" onclick="switchCcTab('sets')" title="Sets"><svg class="cc-tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></svg></button>
                <button class="cc-tab-btn active" data-tab="feed" onclick="switchCcTab('feed')" title="Feed"><svg class="cc-tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></button>
                <button class="cc-tab-btn" data-tab="squads" onclick="switchCcTab('squads')" title="Squads"><svg class="cc-tab-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></button>
            </div>

            <div id="ccContent" class="cc-content">
                
                <div id="view-sets" class="cc-view hidden">
                    <div id="panel-sets" class="scroll-view">
                        <div style="padding:10px; color:#aaa; text-align:center;">Loading Sets...</div>
                    </div>
                </div>

                <div id="view-feed" class="cc-view">
                    <div id="feedChat">
                        <div id="chat">
                            <div class="chat-msg log-message" style="border-left-color:rgba(251,191,36,0.3); background:rgba(0,0,0,0.2);">
                                <div class="chat-text" style="color:#94a3b8;">Waiting for auction...</div>
                            </div>
                        </div>
                        <div class="feed-input-wrapper">
                            <button type="button" class="feed-list-btn" id="soldUnsoldBtn" onclick="toggleSoldUnsoldPopup()" title="Sold / Unsold list" aria-label="Sold Unsold list"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg></button>
                            <input type="text" id="msg" placeholder="Chat..." autocomplete="off">
                            <button type="button" class="chat-send-btn" onclick="sendChat()" aria-label="Send message">‚û§</button>
                        </div>
                    </div>
                </div>

                <div id="view-squads" class="cc-view hidden">
                    <div id="squadTabList" class="horizontal-tabs"></div>
                    <div id="embeddedSquadView" class="scroll-view">
                        <div style="padding:10px; color:#aaa; text-align:center;">Select a team</div>
                    </div>
                </div>
            </div>
            
        </div>

    </div> 
</section>

<section id="playingXI" class="screen hidden">
    <div style="max-width: 800px; margin: 0 auto; padding: 20px; min-height: 100vh;">
        
        <div style="text-align:center; margin-bottom: 10px;">
            <h2 style="margin:0; color:var(--gold); font-size:1.5rem;">üß¢ SELECT PLAYING XI</h2>
        </div>

        <div id="xiStatsBar" style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-bottom: 15px;"></div>

        <div id="xiCardWrapper" class="hidden" style="margin-bottom: 20px;"></div>

        <div id="xiPlaceholder" class="xi-placeholder">
            <div style="font-size:3rem; margin-bottom:10px;">üèè</div>
            Select players below...
        </div>

        <div id="xiButtonRow" style="display: flex; gap: 10px; position: sticky; top: 10px; z-index: 50; background:rgba(15,23,42,0.95); padding:10px 0; border-radius: 8px; border-bottom: 1px solid rgba(255,255,255,0.05);">
            <button id="submitXIBtn" onclick="submitXI()" class="primary-btn" style="flex: 2; box-shadow:0 4px 10px rgba(0,0,0,0.5);">
                Submit XI (0/11)
            </button>
            
            <button onclick="resetXISelection()" class="secondary-btn" title="Reset Selection" style="width:50px; border-color:#ef4444; color:#ef4444; background:#1e293b; font-size: 1.2rem;">
                ‚Üª
            </button>
            
            <button id="saveXIBtn" onclick="downloadSheetPNG()" class="secondary-btn hidden" style="flex: 1; color:var(--gold); border-color:var(--gold); background:#1e293b;">
                üì∏ Save
            </button>
        </div>

        <div id="xiStatus" class="hidden" style="margin-top: 20px; margin-bottom: 25px; position: relative; z-index: 1; min-height: 20px;"></div>

        <div id="mySquadList"></div>
    </div>
</section>

    <section id="leaderboard" class="screen hidden">
        <header class="topbar glass" style="justify-content: center; position: relative;">
            <button onclick="goBackFromLeaderboard()" class="secondary-btn" style="position: absolute; left: 15px; border:none; font-size:1rem;">
                [‚Üê]
            </button>
            <span class="brand" style="font-size: 1.2rem;">üèÜ TOURNAMENT STANDINGS</span>
        </header>

        <div class="lb-container">
            <div class="lb-scroll-wrapper custom-scroll">
                <table class="lb-table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">Rank</th>
                            <th style="text-align: left;">Team</th>
                            <th>Rating</th>
                            <th>Purse</th>
                            <th>Status</th>
                            <th style="width: 60px;">View</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody"></tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="postAuctionSummary" class="screen hidden">
        <header class="topbar glass summary-topbar">
            <div class="summary-topbar-inner">
                <span class="summary-brand">AUCTION SUMMARY</span>
                <button onclick="exitToHome()" class="summary-exit-btn" type="button" aria-label="Exit to main">üè†</button>
            </div>
        </header>

        <div style="max-width: 900px; margin: 0 auto; padding: 20px; padding-top: 80px;">
            <div style="text-align:center; margin-bottom:20px; color:#aaa; font-size:0.9rem;">
                The auction has ended. Tap a team to view their full squad.
            </div>
            <div id="summaryList" style="display:flex; flex-direction:column; gap:10px;"></div>
        </div>
    </section>

    <div id="squadViewOverlay" class="rules-overlay hidden">
    <div class="glass rules-card">
        <div style="padding:15px; border-bottom:1px solid rgba(255,255,255,0.1); display:flex; align-items:center; justify-content:space-between; background:#0f172a;">
            <div style="display:flex; gap:5px;">
                <button id="btnShowXI" onclick="switchPopupView('XI')" class="tab-btn active" style="font-size:0.8rem; padding:6px 12px;">Playing XI</button>
                <button id="btnShowFull" onclick="switchPopupView('FULL')" class="tab-btn" style="font-size:0.8rem; padding:6px 12px;">Full Squad</button>
            </div>
            <button onclick="document.getElementById('squadViewOverlay').classList.add('hidden')" style="background:none; border:none; color:#fff; font-size:1.5rem; cursor:pointer;">&times;</button>
        </div>

        <div id="squadCaptureArea"></div>

        <div id="popupDownloadFooter" style="padding:15px; border-top:1px solid rgba(255,255,255,0.1); background:#0f172a;">
            <button id="downloadPopupCard" onclick="downloadPopupCard()" class="primary-btn" style="width:100%;">üì∏ Download Card</button>
        </div>
    </div>
</div>

    <div id="soldUnsoldOverlay" class="rules-overlay hidden">
        <div class="glass rules-card" style="max-width:480px; max-height:85vh; display:flex; flex-direction:column;">
            <div style="padding:12px 15px; border-bottom:1px solid rgba(255,255,255,0.1); display:flex; justify-content:space-between; align-items:center; background:#0f172a;">
                <div class="sold-unsold-tabs" style="display:flex; gap:8px;">
                    <button type="button" class="sold-unsold-tab active" data-tab="sold" onclick="switchSoldUnsoldTab('sold')"><span>Sold</span> <span id="soldCountBadge" class="count-badge">0</span></button>
                    <button type="button" class="sold-unsold-tab" data-tab="unsold" onclick="switchSoldUnsoldTab('unsold')"><span>Unsold</span> <span id="unsoldCountBadge" class="count-badge">0</span></button>
                </div>
                <button type="button" onclick="closeSoldUnsoldPopup()" style="background:none; border:none; color:#fff; font-size:1.25rem; cursor:pointer; padding:4px;">&times;</button>
            </div>
            <div id="soldUnsoldList" class="custom-scroll" style="flex:1; overflow-y:auto; padding:10px; min-height:200px;"></div>
        </div>
    </div>

    <div id="rulesScreen" class="rules-overlay hidden">
        <div class="overlay-card">
            <h2>‚öôÔ∏è Tournament Setup</h2>
            <div class="rules-scroll-area">
                <div class="rules-section">
                    <h4>üí∞ General Settings</h4>
                    <div class="rule-row"><label>Total Purse (Cr)</label><input id="purse" type="number" value="120"></div>
                    <div class="rule-row"><label>Squad size</label><span style="display:flex; gap:8px; align-items:center;"><input id="minSquadSize" type="number" value="18" min="1" max="30" placeholder="Min"><span style="color:#64748b;">‚Äì</span><input id="maxPlayers" type="number" value="24" min="1" max="30" placeholder="Max"></span></div>
                    <div class="rule-row"><label>Max Foreign (Squad)</label><input id="maxForeign" type="number" value="6"></div>
                    <div class="rule-row rule-row-rtm">
                        <label>RTM?</label>
                        <label class="toggle-switch" style="display:inline-flex; align-items:center; gap:8px;">
                            <input type="checkbox" id="rtmEnabled" unchecked>
                            <span class="slider"></span>
                            <span class="label-text" style="font-size:0.9rem;">No</span>
                        </label>
                    </div>
                    <div class="rule-row" id="rtmCountRow" style="display:none;">
                        <label>RTMs per team</label>
                        <input id="rtmPerTeam" type="number" value="2" min="1" max="10">
                    </div>
                </div>
                <div class="rules-section">
                    <h4>üß¢ Playing XI Requirements</h4>
                    <div class="rule-row"><label>Min Batsmen</label><input id="minBat" type="number" value="3"></div>
                    <div class="rule-row"><label>Min Bowlers</label><input id="minBowl" type="number" value="3"></div>
                    <div class="rule-row"><label>Min Wicket Keepers</label><input id="minWK" type="number" value="1"></div>
                    <div class="rule-row"><label>Min All-Rounders</label><input id="minAll" type="number" value="1"></div>
                    <div class="rule-row"><label>Min Spinners</label><input id="minSpin" type="number" value="1"></div>
                    <div class="rule-row"><label>Max Foreign (Playing XI)</label><input id="maxForeignXI" type="number" value="4"></div>
                </div>
            </div>
            <div class="rules-footer">
                <button id="saveRules" class="primary-btn" style="width:100%;">üîí Lock Rules & Start</button>
            </div>
        </div>
    </div>

    <div id="viewRulesOverlay" class="rules-overlay hidden" onclick="closeRules(event)">
        <div class="glass rules-card" style="max-width: 400px; width: 90%; padding: 0;">
            <div style="padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin:0; color:var(--gold);">üìú Tournament Rules</h3>
                <button onclick="document.getElementById('viewRulesOverlay').classList.add('hidden')" style="background:none; border:none; color:#fff; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div style="padding: 20px;">
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div class="rule-box" style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px;">
                        <div style="font-size:0.8rem; color:#aaa;">üí∞ Total Purse</div>
                        <div style="font-size:1.2rem; font-weight:bold;">‚Çπ<span id="pop_viewPurse">---</span> Cr</div>
                    </div>
                    <div class="rule-box" style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px;">
                        <div style="font-size:0.8rem; color:#aaa;">üë• Squad size</div>
                        <div style="font-size:1.2rem; font-weight:bold;"><span id="pop_viewSquadSize">---</span></div>
                    </div>
                    <div class="rule-box" style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px;">
                        <div style="font-size:0.8rem; color:#aaa;">‚úàÔ∏è Max Foreign</div>
                        <div style="font-size:1.2rem; font-weight:bold;"><span id="pop_viewForeign">---</span></div>
                    </div>
                    <div class="rule-box" id="pop_viewRtmBox" style="background:rgba(255,255,255,0.05); padding:10px; border-radius:8px; display:none;">
                        <div style="font-size:0.8rem; color:#aaa;">üîÑ RTM</div>
                        <div style="font-size:1.2rem; font-weight:bold;"><span id="pop_viewRtm">---</span></div>
                    </div>
                </div>
                <h4 style="margin: 0 0 10px 0; color:var(--primary); font-size:0.9rem; text-transform:uppercase;">Playing XI Requirements</h4>
                <ul style="list-style:none; padding:0; margin:0; font-size:0.9rem; color:#ccc; line-height: 1.6;">
                    <li>üèè Min Batsmen: <span id="pop_viewBat" style="color:#fff; font-weight:bold;">-</span></li>
                    <li>ü•é Min Bowlers: <span id="pop_viewBowl" style="color:#fff; font-weight:bold;">-</span></li>
                    <li>ü•é Spinners: <span id="pop_viewSpin" style="color:#fff; font-weight:bold;">-</span></li>
                    <li>üß§ Min WKs: <span id="pop_viewWK" style="color:#fff; font-weight:bold;">-</span></li>
                    <li>üåü Min All-Rounders: <span id="pop_viewAR" style="color:#fff; font-weight:bold;">-</span></li>
                    <li>‚úàÔ∏é Max Foreign XI: <span id="pop_viewForeignXI" style="color:#fff; font-weight:bold;">-</span></li>
                </ul>
            </div>
            <div style="padding: 15px; text-align:center; border-top: 1px solid rgba(255,255,255,0.1);">
                <button onclick="document.getElementById('viewRulesOverlay').classList.add('hidden')" class="secondary-btn" style="width:100%;">Close</button>
            </div>
        </div>
    </div>

    <div id="identityVerifyOverlay" class="rules-overlay hidden">
        <div class="glass rules-card identity-verify-card" style="max-width: 400px; padding: 20px; padding-top: 44px; text-align: center; position: relative;">
            <button type="button" class="identity-verify-close" onclick="document.getElementById('identityVerifyOverlay').classList.add('hidden')" aria-label="Close and go back">√ó</button>
            <h2 style="color: #fca5a5; border: none;">‚ö†Ô∏è Identity Check</h2>
            <p>A new device is trying to join as <b id="verifyName" style="color: #fff;"></b>.</p>
            <p>Is this you trying to switch devices?</p>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button id="btnVerifyYes" class="primary-btn" style="width: 100%;">Yes, Switch Device</button>
                <button id="btnVerifyNo" class="secondary-btn" style="width: 100%; border-color: #ef4444; color: #ef4444;">No, Block Them</button>
            </div>
        </div>
    </div>

    <div id="rtmOfferOverlay" class="rules-overlay hidden">
        <div class="glass rules-card" style="max-width: 380px; padding: 24px; text-align: center;">
            <h3 style="margin:0 0 8px 0; color:var(--gold);">üîÑ Right to Match</h3>
            <p id="rtmOfferPlayer" style="margin:0 0 16px 0; font-size:1.1rem; color:#f8fafc;"></p>
            <p style="margin:0 0 16px 0; font-size:0.9rem; color:#94a3b8;">Use RTM?</p>
            <div id="rtmOfferYesNo" style="display:flex; gap:12px; justify-content:center; margin-bottom:16px;">
                <button id="rtmOfferYes" class="primary-btn">Yes</button>
                <button id="rtmOfferNo" class="secondary-btn">No</button>
            </div>
            <div id="rtmOfferAmountRow" style="display:none;">
                <label style="display:block; margin-bottom:8px; color:#94a3b8;">Amount (Cr) ‚Äî more than sold price</label>
                <input id="rtmOfferAmount" type="number" min="0" step="0.05" placeholder="0.00" style="width:100%; padding:10px; background:rgba(255,255,255,0.05); border:1px solid #334155; border-radius:8px; color:#fff; font-size:1rem; margin-bottom:8px;">
                <div id="rtmOfferTimer" style="font-size:0.9rem; color:var(--gold); margin-bottom:12px;">15s</div>
                <button id="rtmOfferSubmit" class="primary-btn" style="width:100%;">Submit RTM</button>
            </div>
        </div>
    </div>

    <div id="rtmBuyerChoiceOverlay" class="rules-overlay hidden">
        <div class="glass rules-card" style="max-width: 380px; padding: 24px; text-align: center;">
            <h3 style="margin:0 0 8px 0; color:var(--gold);">üîÑ RTM Match</h3>
            <p id="rtmBuyerChoiceText" style="margin:0 0 16px 0; font-size:1rem; color:#f8fafc;"></p>
            <div style="display:flex; gap:12px; justify-content:center;">
                <button id="rtmBuyerYes" class="primary-btn">Yes, keep at this price</button>
                <button id="rtmBuyerNo" class="secondary-btn">No</button>
            </div>
        </div>
    </div>

    <div id="customBuilderOverlay" class="rules-overlay hidden">
        <div class="glass rules-card" style="max-width: 600px; height: 85vh; display:flex; flex-direction:column;">
            <div style="padding:15px; border-bottom:1px solid rgba(255,255,255,0.1); display:flex; justify-content:space-between; align-items:center; background:#0f172a;">
                <div>
                    <h3 style="margin:0; color:var(--gold);">üõ†Ô∏è Build Custom Set</h3>
                    <div style="font-size:0.75rem; color:#94a3b8;">Select players & edit ratings</div>
                </div>
                <button onclick="closeCustomBuilder()" style="background:none; border:none; color:#fff; font-size:1.5rem;">&times;</button>
            </div>

            <div style="padding:15px; background:rgba(0,0,0,0.2);">
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <input id="customSearch" type="text" placeholder="Search Name..." onkeyup="filterCustomList()" style="flex:2; padding:8px; background:rgba(255,255,255,0.05); border:1px solid #334155;">
                    <select id="customRoleFilter" onchange="filterCustomList()" style="flex:1; background:#1e293b; color:white; border:1px solid #334155; border-radius:8px; padding:0 5px;">
                        <option value="">All Roles</option>
                        <option value="BAT">Batters</option>
                        <option value="BOWL">Bowlers</option>
                        <option value="ALL">All-Rounders</option>
                        <option value="WK">Wicket Keepers</option>
                    </select>
                </div>
                <div style="display:flex; align-items:center; gap:16px; flex-wrap:wrap;">
                    <label class="toggle-switch" style="padding:5px 10px; background:transparent; border:none; margin:0;">
                        <input type="checkbox" id="autoSelectPoolToggle" onchange="toggleAutoSelectPool()">
                        <span class="slider" style="width:34px; height:18px;"></span>
                        <span class="label-text" style="font-size:0.8rem;">Auto select</span>
                    </label>
                    <label class="toggle-switch" style="padding:5px 10px; background:transparent; border:none; margin:0;">
                        <input type="checkbox" id="useRatingsToggle" onchange="toggleRatingVisibility()">
                        <span class="slider" style="width:34px; height:18px;"></span>
                        <span class="label-text" style="font-size:0.8rem;">Ratings</span>
                    </label>
                </div>
            </div>

            <div id="customPlayerList" class="custom-scroll" style="flex:1; overflow-y:auto; padding:10px;">
                <div style="text-align:center; padding:20px; color:#666;">Loading Database...</div>
            </div>

            <div style="padding:15px; border-top:1px solid rgba(255,255,255,0.1); background:#0f172a; display:flex; justify-content:space-between; align-items:center;">
                <div style="font-size:0.9rem;">Selected: <b id="customCount" style="color:var(--success);">0</b></div>
                <button onclick="saveCustomSet()" class="primary-btn" style="padding:8px 20px;">‚úÖ Confirm Set</button>
            </div>
        </div>
    </div>

    <section id="godPanel" class="screen hidden" style="background:#000; position:fixed; inset:0; z-index:9999;">
        <div class="glass" style="max-width:600px; margin:20px auto; padding:20px; height:90vh; display:flex; flex-direction:column; border:1px solid #ef4444;">
            <div style="border-bottom:1px solid #333; padding-bottom:10px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center;">
                <h2 style="margin:0; color:#ef4444; font-size:1.2rem;">GOD MODE</h2>
                <button onclick="window.location.reload()" class="secondary-btn" style="padding:5px 10px; font-size:0.8rem;">Exit</button>
            </div>
            <div id="godLogin">
                <p style="color:#aaa; font-size:0.9rem;">Enter the Room Code you want to manipulate:</p>
                <div style="display:flex; gap:10px; flex-wrap:wrap;">
                    <input id="godTargetInput" placeholder="Room Code" style="text-transform:uppercase; flex:1; min-width:120px;">
                    <button type="button" id="godAccessBtn" class="primary-btn" style="background:#ef4444;">Access</button>
                </div>
                <div id="godRoomNotFound" class="hidden" style="margin-top:12px; padding:10px 14px; background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.3); border-radius:8px; color:#f87171; font-weight:600;">Room not found</div>
            </div>
            <div id="godContent" class="hidden" style="flex:1; overflow:hidden; display:flex; flex-direction:column;">
                <div style="margin-bottom:8px;">
                    <input id="godSearchInput" type="text" placeholder="Search players..." style="width:100%; padding:8px 12px; background:rgba(0,0,0,0.3); border:1px solid #333; border-radius:8px; color:#fff; font-size:0.9rem;">
                </div>
                <div class="god-header" style="display:flex; justify-content:space-between; color:#666; font-size:0.75rem; padding-bottom:5px;">
                    <span>PLAYER</span> <span>ASSIGN TO</span>
                </div>
                <div id="godPlayerList" style="flex:1; overflow-y:auto; padding-right:5px;"></div>
            </div>
        </div>
    </section>

    <script>
        // Command Center Tabs
        function switchCcTab(tabName) {
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('.view-panel').forEach(panel => panel.classList.remove('active'));
            document.getElementById(`view-${tabName}`).classList.add('active');
        }
        function switchFeedMode(mode) {
            document.querySelectorAll('.sub-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            document.querySelectorAll('.feed-mode-container').forEach(container => container.classList.remove('active'));
            document.getElementById(`mode-${mode}`).classList.add('active');
        }
        let isMaximized = false;
        let isCollapsed = false;
        function toggleMaximize() {
            const cmdCenter = document.getElementById('commandCenter');
            isMaximized = !isMaximized;
            cmdCenter.classList.toggle('maximized', isMaximized);
        }
        function toggleCcExpand() {
            const cmdCenter = document.getElementById('commandCenter');
            isCollapsed = !isCollapsed;
            cmdCenter.classList.toggle('collapsed', isCollapsed);
            document.getElementById('expandBtn').textContent = isCollapsed ? '‚ñ°' : '‚àí';
        }
    </script>
<div id="customPopup" class="cp-overlay hidden">
    <div class="cp-card">
        <div class="cp-border-gradient"></div>
        
        <div class="cp-inner">
            <div class="cp-icon" id="cpIcon">‚ö†Ô∏è</div>
            <h3 class="cp-title" id="cpTitle">Confirm Action</h3>
            <p class="cp-msg" id="cpMessage">Are you sure you want to proceed?</p>
            
            <div class="cp-actions">
                <button id="cpBtnCancel" class="cp-btn cp-btn-cancel">CANCEL</button>
                <button id="cpBtnOk" class="cp-btn cp-btn-ok">CONFIRM</button>
            </div>
        </div>
    </div>
</div>

    <footer class="app-footer">
        <div class="footer-content">
            <span>Made with <span style="color:#e11d48;">‚ù§Ô∏è</span> by <b>PRS</b></span>
            <span class="separator">‚Ä¢</span>
            <div class="social-links">
                <!-- Discord -->
<a href="https://discord.gg/gpACU3Gdg"
   target="_blank"
   rel="noopener"
   class="footer-social discord"
   title="Discord"
   aria-label="Discord">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
    <path d="M20.317 4.369a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.211.375-.444.864-.608 1.249a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.249.077.077 0 0 0-.079-.037 19.736 19.736 0 0 0-4.885 1.515.07.07 0 0 0-.032.027C.533 9.045-.319 13.58.099 18.057a.082.082 0 0 0 .031.056 19.9 19.9 0 0 0 5.993 3.03.077.077 0 0 0 .084-.027c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.105 13.201 13.201 0 0 1-1.872-.9.077.077 0 0 1-.008-.128c.126-.095.252-.192.371-.291a.074.074 0 0 1 .077-.01c3.927 1.793 8.18 1.793 12.061 0a.074.074 0 0 1 .078.01c.12.099.246.196.372.291a.077.077 0 0 1-.006.128 12.3 12.3 0 0 1-1.873.899.076.076 0 0 0-.04.106c.36.698.772 1.364 1.225 1.994a.076.076 0 0 0 .084.028 19.876 19.876 0 0 0 6.002-3.03.077.077 0 0 0 .031-.055c.5-5.177-.838-9.673-3.548-13.66a.061.061 0 0 0-.031-.028z"/>
  </svg>
</a>

<!-- WhatsApp -->
<a href="https://whatsapp.com/channel/0029Vb7Z5EABKfi1oKCpTB3j"
   target="_blank"
   rel="noopener"
   class="footer-social whatsapp"
   title="WhatsApp"
   aria-label="WhatsApp">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
    <path d="M12.04 0C5.409 0 .04 5.37.04 12c0 2.123.555 4.196 1.61 6.03L0 24l6.18-1.61A11.96 11.96 0 0 0 12.04 24C18.67 24 24.04 18.63 24.04 12S18.67 0 12.04 0zm6.79 16.97c-.29.82-1.7 1.57-2.35 1.66-.62.09-1.4.13-4.56-1.55-3.82-2.02-6.28-5.59-6.47-5.86-.18-.27-1.56-2.08-1.56-3.97s.99-2.82 1.34-3.21c.35-.39.77-.49 1.03-.49h.74c.24 0 .56-.09.87.66.29.74 1.02 2.55 1.11 2.73.09.18.15.39.03.63-.12.24-.18.39-.36.6-.18.21-.38.47-.54.63-.18.18-.37.38-.16.74.21.36.95 1.57 2.04 2.54 1.4 1.25 2.59 1.64 2.95 1.82.36.18.57.15.78-.09.21-.24.9-1.05 1.14-1.41.24-.36.48-.3.81-.18.33.12 2.1.99 2.46 1.17.36.18.6.27.69.42.09.15.09.87-.2 1.69z"/>
  </svg>
</a>

                <a href="#" target="_blank" rel="noopener" class="footer-social" title="GitHub" aria-label="GitHub"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg></a>
                <a href="#" target="_blank" rel="noopener" class="footer-social" title="Telegram" aria-label="Telegram"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg></a>
                <a href="#" target="_blank" rel="noopener" class="footer-social" title="Twitter / X" aria-label="Twitter"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg></a>
                <a href="#" target="_blank" rel="noopener" class="footer-social" title="Instagram" aria-label="Instagram"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></a>
                <a href="#" target="_blank" rel="noopener" class="footer-social" title="Facebook" aria-label="Facebook"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
            </div>
        </div>
    </footer>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/client.js"></script>
    <script type="module" src="/assets/landing.js"></script>
</body>
</html>
